태그: #Cloud 
연결문서: [Cloud - 운영 환경 구성 3](Cloud%20-%20운영%20환경%20구성%203.md)

# 서버 배포

## EC2 인스턴스 연결

### 인스턴스 관리
- 인스턴스 탭에서 연결하고자 하는 인스턴스를 선택한 후 연결 버튼을 클릭하면 인스턴스에 연결하는 방법을 확인할 수 있음
- EC2 인스턴스는 하나의 컴퓨터(운영 체제)와 같기 때문에 인스턴스를 사용하지 않을 때 꺼놓거나 재부팅할 수 있음
- 대시보드에서 발급받은 인스턴스를 선택하면 오른쪽 위에 [인스턴스 상태 ▼] 버튼이 있고, 이 버튼을 클릭하면 나오는 목록은 다음과 같은 기능을 함
    - 인스턴스 중지 (Stop instance)
        - 인스턴스가 종료됨
        - [인스턴스 상태] > [인스턴스 시작] 버튼을 이용해 다시 시작할 수 있음
        - [인스턴스 종료]와 다름
        - 운영 체제를 종료하는 것과 같음
    - 인스턴스 시작 (Start instance)
        - 인스턴스를 다시 사용할 수 있는 실행(running) 상태로 변환함
        - 운영 체제를 시작하는 것(부팅)과 같음
        - [인스턴스 상태] 옆의 주황색 [인스턴스 시작] 버튼과는 다름
        - AWS 콘솔의 언어를 영어로 변경해 보면 주황색 [인스턴스 시작] 버튼은 Launch instances로 인스턴스 생성과 같음
    - 인스턴스 재부팅 (Reboot instance)
        - 인스턴스를 재부팅함
        - 운영 체제 재부팅과 같음
    - 인스턴스 최대 절전 모드 (Hibernate instance)
        - Amazon Linux와 특정 이미지의 인스턴스에서 지원하는 수면모드
    - 인스턴스 종료 (Terminate instance)
        - 인스턴스를 삭제함
        - 운영 체제 종료가 아닌, 운영 체제 삭제와 같음

<br>

## EC2 인스턴스 생성/연결 튜토리얼

### EC2 Instance 생성
- AWS 메뉴에서 EC2 서비스를 검색하고 접속하여 인스턴스 시작 버튼을 클릭하여 인스턴스 생성을 시작할 수 있음
<br>

![](image_47.png)

<br>

- EC2 Instance 생성(Optional)
    - AWS의 화면은 시기에 따라 다르게 보일 수 있음
    - UI 만 다를 뿐 구성요소는 동일하기 때문에 그대로 진행해도 괜찮지만, 이전 버전의 화면으로 변환하고 싶은 경우 오른쪽 상단의 이전 경험으로 옵트아웃 버튼을 클릭하여 이전 버전의 UI 로 진행할 수 있음
<br>

![](image_48.png)

<br>

- 용도에 맞게 AMI를 선택하는 과정으로, Ubuntu 인스턴스를 생성함
    - 프리 티어 사용 가능 태그를 확인하여 과금이 되지 않도록 유의해야 함
    - Ubuntu 인스턴스를 생성할 때 20버전, 혹은 그 이하 버전을 권장함
<br>

![](image_49.png)

<br>

- 인스턴스 유형을 선택하는 과정으로, 생성하는 인스턴스의 CPU, RAM, 용량에 대한 선택이 가능함
    - 프리 티어 사용 가능 태그를 확인하여 과금되지 않는 유형을 선택함
<br>

![](image_50.png)

<br>

- 검토 및 시작 버튼을 클릭하면 다음과 같은 화면이 보임
    - 생성되는 인스턴스를 원격으로 제어하기 위해서는 SSH 연결을 통한 원격접속이 필요함
    - 원격접속을 위해서 필요한 Key를 생성하고 다운로드하는 과정
    - 새 키 페어 생성 메뉴를 확인한 후 키 페어의 이름을 정한 뒤 키 페어를 다운로드하면 인스턴스 시작 버튼이 활성화 됨
<br>

![](image_51.png)

<br>

- SSH 프로토콜을 통한 원격접속과 키 페어(.pem 파일)
    - SSH(Secure Shell) Protocol은 PC와 PC가 인터넷과 같은 Public Network를 통해 통신을 할 때 보안상 안전하게 통신을 하기 위한 프로토콜(통신 규약)
    - 주고받는 데이터를 암호화해서 해당 키 페어를 가지지 않은 사람은 통신되는 데이터를 알아볼 수 없기 때문에 보안상 안전한 통신 방법

<br>

- EC2 프라이빗 키파일(.pem 파일)
    - .pem 확장자를 가진 파일은 AWS에서 빌린 PC를 원격으로 제어하기 위해서 SSH 통신을 위해 필요한 Private Key가 기록된 파일
    - 인스턴스 생성 마지막 단계에서 다운로드 한 파일은 SSH 통신을 위한 키 페어 중 프라이빗 키가 기록된 파일로 .pem 확장자를 가지고 있음
    - 해당 키 페어 파일은 EC2 인스턴스에 연결을 할 때 사용하는 암호가 담긴 파일로, pem 파일은 관리에 유의해야 함

<br>

- 많은 인스턴스가 생성되어 있는 경우 인스턴스를 생성하면서 알려주는 인스턴스 ID를 통해 인스턴스를 구분할 수 있음
    - 우측 하단의 인스턴스 보기 버튼을 클릭하여 생성한 인스턴스를 확인함
<br>

![](image_52.png)

<br>

- 인스턴스 탭에서 생성된 인스턴스를 확인할 수 있음
    - 인스턴스 ID를 통해 인스턴스를 구분할 수 있지만 생성된 인스턴스가 많아지는 경우 알아보기 힘들 수 있음
<br>

![](image_53.png)

<br>

- Name 컬럼에서 해당 인스턴스의 이름을 알아보기 쉽도록 설정해두면 각 인스턴스를 구분하기 용이해짐
<br>

![](image_54.png)

<br>

- 이제 인스턴스가 생성되었지만, 앞에 놓인 PC와 다르게 인스턴스는 직접 조작할 수 없음
- 생성한 인스턴스에 원격접속하여 원격으로 인스턴스를 제어할 수 있음
- 인스턴스에 원격접속을 하기 위해서 필요한 것이 인스턴스를 생성할 때 다운로드한 키 페어 파일(.pem)
- SSH 연결을 통해서 인스턴스에 접속해야 함

<br>

- 인스턴스 탭에서 연결하고자 하는 인스턴스를 선택한 후 연결 버튼을 클릭하면 인스턴스에 연결하는 방법을 확인할 수 있음
<br>

![](image_55.png)

<br>

![](image_56.png)

<br>

- 로컬 터미널에서 SSH 프로토콜을 이용해서 인스턴스와 연결이 가능하지만, 먼저 다운로드했던 키 페어 파일(.pem)의 권한을 수정해야 함
- pem 파일에 누구나 접근할 수 있는 권한이 부여되어 있다면 인스턴스는 연결을 거부함

<br>

![](image_57.png)

<br>

- chmod란?
<br>

![](image_58.png)

<br>

- 키 페어 파일(.pem)의 권한을 수정하지 않은 경우 권한이 너무 open되어있다는 경고 메시지와 함께 접속이 거절됨
- chmod 400 [다운로드한 키 페어 파일(.pem)의 경로] 명령어를 입력하여 키 페어 파일(.pem)의 권한을 수정함
- 파일 권한을 설정했다면 ssh 명령어를 통해 인스턴스에 접속할 수 있음
- ssh 접속을 위한 주소는 인스턴스를 클릭하면 보이는 세부 정보 탭에서도 확인할 수 있음

<br>

- ssh 명령어를 통한 인스턴스 접속
<br>

![](image_59.png)

<br>

- SSH 명령어를 올바르게 입력하면 다음과 같은 메시지가 터미널에 출력됨
    - 해당 메시지는 EC2 인스턴스에 처음 접속할 시 나오는 경고 메시지
    - 'yes'를 입력하여 다음 과정으로 넘어감
<br>

![](image_60.png)

<br>

- 다음과 같이 나오면 SSH 프로토콜을 이용한 원격 접속이 성공적으로 연결된 것
- 명령어를 통한 AWS에서 빌린 가상 PC를 사용할 수 있음
<br>

![](image_61.png)