태그: #정보처리기사 
연결문서: [보안 공격 및 예방 6](보안%20공격%20및%20예방%206.md)

# 03. 정보보호 대책

## 04. IPS의 구축 방식

### 1) 단일 홈 게이트웨이(Single-Homed Gateway) 구조
- 베스천 호스트 구조
- 베스천 호스트에 통신 네트워크 카드 1개를 장착하여 사용함
- 베스천 호스트에는 일반 사용자 계정이 없어야 하며, 방화벽에 관련되지 않은 유틸리티가 존재해서는 안 됨
- 베스천 호스트에는 IP 포워딩(외부 IP 주소로 내부 IP주소를 연결하는 작업) 및 라우팅 기능이 없어야 함
- 베스천 호스트에 설치된 운영체제의 보안 기능을 사용하기 때문에 2계층 공격에 취약함

<br>

### 2) 이중 홈 게이트웨이(Dual-Homed Gateway) 구조
- 베스천 호스트에 LAN 카드를 양쪽에 2개 장착하여 사용함
- 단일 홈 게이트웨이가 2개 있는 것처럼 운영됨
- 내부, 외부 네트워크에 접근하기 위해서는 홈 게이트웨이를 2번 거쳐야 함

<br>

### 3) 스크린 호스트 게이트웨이(Screen-Host Gateway) 구조
- 단일 홈 게이트웨이 구조에 패킷 필터링 라우터를 추가하여 사용함
- 베스천 호스트는 패킷 필터링 라우터를 거치지 않은 데이터는 접속을 차단함
- 패킷 필터링 라우터 또한 베스천 호스트를 거치지 않는 외부 네트워크의 접속은 차단함
- 인터넷에서 내부 네트워크로 전송되는 패킷을 패킷 필터링 라우터에서 필터링함으로써 1차 방어를 수행함
- 베스천 호스트에서는 필터링 된 패킷을 프록시와 같은 서비스를 통해 2차 방어 후 내부 네트워크로 전달함

<br>

### 4) 이중 홈 게이트웨이+스크린 호스트 게이트웨이 구조
- 베스천 호스트에 LAN 카드를 양쪽에 2개 장착하고, 외부에 패킷 필터링 라우터를 설치함
- 이중 홈 게이트웨이 구조에 패킷 필터링 라우터를 추가하여 사용함
- 베스천 호스트는 패킷 필터링 라우터를 거치지 않은 데이터는 접속을 차단함
- 패킷 필터링 라우터 또한 베스천 호스트를 거치지 않은 외부 네트워크의 접속은 차단함
- 융통성이 있으며 보안성이 좋아 가장 많이 사용하는 구조
- 구축 비용이 많이 듦

<br>

### 5) 스크린 서브넷 게이트웨이(Screen-Subnet Gateway) 구조
- 베스천 호스트 양쪽에 패킷 필터링 라우터를 설치한 후 외부 쪽에 LAN 카드를 설치함
- 스크린 호스트 게이트웨이 구조로 내부 네트워크 시스템 쪽에 패킷 필터링 라우터를 추가하여 사용함
- 내부, 외부 네트워크 사이에 완충 지대의 네트워크를 두고 사용함
- 다단계 보안을 제공하기 때문에 강력한 보안을 제공함
- 베스천 호스트의 침해가 전체 내부 네트워크에 침해로 확산되지 않음
- DMZ라는 완충 지역 개념을 이용함
- 방화벽에 의해 보호받지 않는 영역을 DMZ라고 하며 특별히 외부로 노출되어야 할 서버들은 DMZ에 위치함
- 인터넷 공유기에서 포트 포워드 이외에 DMZ라고 해서 내부 IP 주소와 내부 포트를 외부에 아무런 차단 없이 열어둘 수 있는 설정을 할 수 있음
- 보안성이 뛰어나지만 설치와 관리가 어렵고 구축 비용이 많이 듦
- 전체 네트워크의 성능 저하 가능성이 크고 속도가 느림

<br>

### 6) 이중 홈 게이트웨아+스크린 서브넷 게이트웨이 구조
- 베스천 호스트 양쪽에 패킷 필터링 라우터를 설치한 후 외부 쪽에 LAN 카드를 설치함
- 이중 홈 게이트웨이+스크린 호스트 게이트웨이 구조로 내부 네트워크 시스템 쪽에 패킷 필터링 라우터를 추가하여 사용함
- 보안이 강력하지만 복잡하고 구축 비용이 많이 듦
- 전체 네트워크의 성능이 저하됨

<br>

### 7) IPS 구축 시 고려사항
1. 네트워크 접속의 정책 결정
    - 내부 네트워크의 접속에 대한 철저한 분석과 정책 결정을 고려해야 함
    - 내부 네트워크 접속을 모두 차단할 것인지 아닌지 결정해야 함
    - 홈페이지 서비스나 파일 제공 서비스를 하게 된다면 접속 허용 리스트를 결정해야 함
    - 운영 상의 문제점이나 위험 요소에 대한 철저한 대비 정책을 고려해야 함
2. 모니터링 백업의 제어
    - 내부 네트워크의 접속을 계속적으로 주시하면서 위험 요소를 어떻게 제거할 것인지 고려해야 함
    - 공격을 당했을 때 공격자의 추적 시스템이나 백업 시스템의 상태를 제어할 수 있는지 고려해야 함
3. 보안 비용
    - 방화벽 시스템의 구축 비용과 인건비 등을 고려해야 함
    - 정부 시스템, 은행 시스템과 같은 강력한 보안을 필요로 하는 시스템과 그렇지 않아도 되는 시스템의 보안 비용을 구분해야 함
4. 서비스의 설치 및 구성
    - 웹 서버에서 제공되는 웹 페이지는 공격 대상에 매우 취약한 부분
    - 웹 페이지의 소스를 열어보지 못하도록 하거나 보안성을 가준 웹 언어의 사용을 고려해야 함
    - 파일을 입출력 할 수 있는 서비스인 FTP는 내부 네트워크에 악성 프로그램이 설치될 수 있으므로 익명 접근의 사용을 제한하거나 FTP 서버의 접근 권한 설정을 고려해야 함
    - 개인 E-메일을 이용하여 내부 네트워크를 불법 접근하거나 악성 프로그램을 설치하게 할 수 없도록 일반 사용자의 보안 교육이나 관리 체계를 고려해야 함

<br>

---

<br>

## 05. IDS(Intrusion Detection System, 침입 탐지 시스템)의 개념

### 1) IDS의 정의
- 네트워크에서 허가되지 않은 비정상적인 행동을 탐지하고, 불법적인 행위와 침입 여부를 확인한 후, 이에 대응할 수 있는 기능을 가진 보안 시스템

<br>

### 2) IDS의 특징
- 외부 공격자뿐만 아니라 내부 공격자의 해킹 유형에 따라 공격을 탐지할 수 있음
- IDS는 공격에 대한 통계 분석, 로그 파일 분석, 트래픽의 상태 등을 탐지하는 수동적인 기능을 가진 시스템
- IDS는 IPS처럼 자체적으로 비정상적인 침입을 차단하거나 중단 시키지는 못함
- IDS는 사용자나 관리자에게 침입을 탐지하여 공격에 대한 경고 메시지를 전달하는 역할
- IDS는 암호화된 공격형 패킷은 탐지할 수 없음
- IDS에서 수집한 데이터는 원격지 시스템에서 모아서 관리함
- 방대한 로그 정보가 남게 되면 정상적인 데이터와 구분하기가 어려워 로그 기록 파일을 체계적으로 관리해야 함
- IDS는 방화벽과 상호 보완적으로 사용할 수 있음

<br>

### 3) Snort
- Snort는 Sniffer and more라는 말로 더욱 강력한 네트워크 트래픽 감시 및 분석 프로그램이라는 의미를 가지고 있음
- 소스파이어에서 개발한 오픈소스 네트워크 침입 방비/탐지 시스템으로 가장 오랫 동안 넓게 사용되고 있는 IDS/IPS 기술
- 단순한 패킷 스니퍼 프로그램으로 룰을 이용한 분석 기능이 추가된 프로그램
- 커뮤니티를 통하여 지속적인 탐지 룰을 제공하고 있으므로 많은 사람에게 인기가 많음
- 현재 Windows, UNIX, Linux에 이르기까지 다양한 운영체제를 지원하고 있음
- Snort는 프로토콜 분석, 데이터를 검색 및 비교하여 다양한 공격을 탐지해낼 수 있음

<br>

### 4) Snort 기능
1. 패킷 스니퍼(Libpcap) : 네트워크의 패킷을 읽어 보여주는 기능을 함
2. 패킷 로그 남기기(Syslog) : 감시한 패킷을 저장하고 로그에 기록하는 기능을 함
3. Network IPS 기능(Snort 공격 룰 비교) : 네트워크 트래픽을 분석하고 공격을 탐지함
4. 프로토콜 분석, 콘텐츠 검색, Buffer Overflows, Stealth Port Scans 등의 기능을 수행함

<br>

### 5) Snort 구조
- Snort의 기본 구조는 Sniffer(스니퍼), Preprocessor(전처리기), 탐지 엔진, 로깅&경로의 네 가지 구성 요소로 이루어져 있음
- Sniffer
    - Snort IDS를 통과하는 모든 패킷을 수집하는 역할을 함
    - 이더넷 인터페이스를 Promiscuous 모드로 동작하게 하여 패킷을 모두 수집할 수 있도록 함
- 전처리기
    - Sniffer에서 캡처한 네트워크 패킷은 탐지 엔진에서 비교하기 전에 사전 처리 작업을 해주는 역할을 함
- 탐지 엔진
    - Snort의 핵심 부분으로 패킷과 룰을 비교하여 패킷에 해당하는 룰이 있을 경우 경고를 발생함
- 로깅&경고
    - Snort가 발생 시킨 경고는 출력 모듈로 전송됨
    - 출력 모듈 또한 플러그인 구조로 되어 있어 로그 파일, 네트워크 연결, 소켓, SNMP 트랩, MySQL과 같은 SQL 데이터베이스로 경고를 보낼 수 있음

<br>

### 6) IDS의 4가지 구성 단계
1. 데이터 수집
    - 공격자의 정보, 침입 유형의 정보, 보호하려는 시스템의 모든 정보를 모으는 단계
2. 필터링 및 축약
    - 보호하려는 시스템에 침입 가능성이 있는 데이터들을 걸러냄
3. 분석 및 침입 탐지
    - 침입 가능성의 데이터를 분석하고, 공격의 침입을 탐지하게 함
4. 추적과 대응 보고
    - 공격자의 침입이 탐지 되면 신속히 공격자를 추적할 수 있는 시스템을 가동하여, 피해를 최소화하도록 조처함
    - 결과에 대한 기록도 차후에 발생할 공격에 대비하기 위하여 문서화함
    - 침입의 형태와 추적 및 대응에 관한 결과를 보고서로 작성함

<br>

---

<br>

## 06. HIDS와 NIDS

### 1) 호스트 기반의 침입 탐지 시스템(HIDS : Host IDS)
- IDS가 컴퓨터 시스템 내부에 설치되어 컴퓨터 내부 사용자들의 활동을 감시하고 해킹을 탐지하는 보안 시스템
- Host IDS는 응용 프로그램과 컴퓨터 시스템 로그 파일 등의 정보를 설치된 운영체제로부터 가져옴
- HIDS는 운영체제에 설정된 사용자의 계정에 따라 어떤 사용자가 어떤 접근을 시도하고 어떤 작업을 했는지에 대한 기록을 남기고 추적함

<br>

### 2) 네트워크 기반의 침입 탐지 시스템(NIDS : Network IDS)
- 네트워크를 경유하는 패킷들을 분석하여 해킹을 탐지하는 네트워크 보안 시스템
- DoS 공격, 패킷 조작 등의 공격을 감지하기 위해서는 NIDS를 사용함
- 일반적으로 IDS는 NIDS를 말함
- NIDS는 패킷의 정보나 포트 정보를 획득하여 해킹을 탐지함
- 패킷 내의 데이터 블록이나 특정 문자열에 존재하는 침입 정보를 탐지해냄
- 모든 패킷이 분할 되어 네트워크에 접근하고 재조립 되기 때문에 네트워크에 부하가 많아지면 패킷 전부를 분석할 수 없어 해킹을 탐지 못하는 경우도 발생함
- HIDS와 NDIS가 동시에 운영될 때 보안성이 좋아짐

<br>

### 3) NIDS의 설치 위치에 따른 특징

![](image_09.png)

- 1번 위치(패킷이 라우터에 들어오기 전의 위치)
    - 네트워크로 들어오는 모든 공격을 탐지할 수 있는 장점이 있으나 수집할 패킷의 데이터 양이 많기 때문에 NIDS의 성능이 좋아야 함
- 2번 위치(라우터의 뒤)
    - 라우터의 패킷 필터링을 거친 후에 패킷을 검사하므로 수집할 패킷의 데이터 양이 적고, 탐지 기능이 1번 위치보다 강력함
- 3번 위치(방화벽 뒤)
    - 방화벽 뒤에서 탐지되는 공격은 내부 네트워크에 가장 영향을 많이 받으므로, IDS와 방화벽의 협조가 매우 중요함
    - 내부 공격자의 탐지가 가능하여 한 개의 침입 탐지 시스템을 설치해야 한다면 3번 위치가 적당함
- 4번 위치(내부 네트워크)
    - 내부 네트워크의 공격을 탐지하고자 할 경우에 설치할 수 있는 곳
    - 내부 네트워크가 공격을 받으면 무방비 상태가 됨
    - 의도적이든 비의도적이든 해킹 공격의 대부분을 차지하는 위치
- 5번 위치(DMZ)
    - 강력한 내부, 외부 공격자에게 중요한 데이터 손실이나 파괴를 막기 위한 위치

<br>

### 4) DMZ(Demilitarized Zone)
- DMZ 내에는 외부 사용자가 접근해야 하는 웹 서버, DNS 서버, 메일 서버 등이 위치할 수 있음
- 외부 네트워크에서는 DMZ에 접근할 수 있으므로 보안 수준을 높여야 함
- 내부 사용자가 DMZ에 접속하기 위해서는 외부 방화벽은 거칠 필요가 없고, 내부 방화벽이 있는 경우에는 내부 방화벽을 거쳐야 함
- DMZ는 보안 조치가 취해진 네트워크 영역으로, 경우에 따라서는 내부 방화벽과 외부 방화벽 사이에 위치할 수 있음

<br>

---

<br>

## 07. 침입 탐지 모델에 의한 구분

### 1) 오용 탐지(Misuse Detection)
- 잘 알려진 시스템의 취약점을 공격하는 패턴의 침입을 탐지하는 방법
- 지식 기반 탐지 방식으로 특정 공격에 관한 분석 결과를 바탕으로 패턴을 설정함
- 기존 공격의 패턴을 이용한 공격을 감지하기 위해 시그니처 기반 감지 방식을 사용함
- 미리 축적한 시그니처와 일치하면 침입으로 판단함
- 각종 공격에 대한 특징을 분석하여 이를 감지할 수 있는 패턴 형태를 데이터베이스에 저장하고 비교하여 실시간으로 동일한 패턴의 공격을 탐지하는 방법
- 잘 알려진 취약한 부분을 주로 공격하므로 비교적 공격 탐지의 정확도가 높은 방법
- 공격 형태의 상태를 데이터베이스에 저장하여 관리하므로 침입 예상 형태를 파악하기 쉽기 때문에, 잘못된 경보율(False Alarm)이 낮음
- 새로운 공격 유형의 정보 수집이 어려우며, 새로운 취약점 정보를 패턴화 하여 지식 데이터베이스로 유지 및 관리하기가 쉽지 않음
- 데이터베이스에 수집된 자료를 저장하고 분석해야 하므로 시간이 많이 낭비됨
- 트로이목마, 백도어 공격 등을 탐지할 수 있음

<br>

### 2) 이상 탐지(Anomaly Detection, 변칙 탐지, 비정상 행위 탐지)
- 잘 알려지지 않은 공격을 탐지하는 데 적합한 기법
- 통계적 분석 방법 등을 활용하여 급격한 변화를 발견하면 침입으로 판단함
- 정상 행위를 가려내기 위한 명확한 기준을 설정하기 어려움
- 사용자의 행동을 수집하고 분석하여 통계적인 분석 방법에 따라 침입을 탐지하는 방법
- 정상적인 사용자들의 행동 유형들의 정보를 수집한 후, 현재 사용자들의 활동과 비교하여 차이점으로 침입을 찾는 방법
- 정상적인 사용자도 언제든 비정상적인 행위를 할 수 있으므로 경보율이 높은 편
- 제로 데이 공격을 탐지하기에 적잡함
- 정량 분석법(Quantitative Analysis)
    - 정상 사용자의 비정상적인 행위를 비율적인 수치로 두어, 그 이상의 비정상적인 행동이 발생하면 침입이라고 판단하는 방법
    - 비율적인 수치를 임계치라고 하며 정확한 설정이 필요함
- 신경망 분석법(Neural Network Analysis)
    - 정상 사용자가 사용한 명령어 형태를 신경망 형태의 그래프로 표현하여 정상 사용자의 패턴을 파악한 후, 그 패턴에서 벗어나게 되면 침입이라고 판단하는 방식
    - 비정상적인 행위가 발생하더라도 정상적인 사용자의 패턴이 유사하면 정상 사용자로 판단함